/*
 tableExport.jquery.plugin

 Version 1.10.2

 Copyright (c) 2015-2018 hhurz, https://github.com/hhurz

 Original Work Copyright (c) 2014 Giri Raj

 Licensed under the MIT License
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(d,l,u){d instanceof String&&(d=String(d));for(var w=d.length,x=0;x<w;x++){var P=d[x];if(l.call(u,P,x,d))return{i:x,v:P}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,l,u){d!=Array.prototype&&d!=Object.prototype&&(d[l]=u.value)};
$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(d,l,u,w){if(l){u=$jscomp.global;d=d.split(".");for(w=0;w<d.length-1;w++){var x=d[w];x in u||(u[x]={});u=u[x]}d=d[d.length-1];w=u[d];l=l(w);l!=w&&null!=l&&$jscomp.defineProperty(u,d,{configurable:!0,writable:!0,value:l})}};
$jscomp.polyfill("Array.prototype.find",function(d){return d?d:function(d,u){return $jscomp.findInternal(this,d,u).v}},"es6","es3");
(function(d){d.fn.tableExport=function(l){function u(b){var c=[];x(b,"thead").each(function(){c.push.apply(c,x(d(this),a.theadSelector).toArray())});return c}function w(b){var c=[];x(b,"tbody").each(function(){c.push.apply(c,x(d(this),a.tbodySelector).toArray())});a.tfootSelector.length&&x(b,"tfoot").each(function(){c.push.apply(c,x(d(this),a.tfootSelector).toArray())});return c}function x(b,c){var a=b[0].tagName,h=b.parents(a).length;return b.find(c).filter(function(){return h===d(this).closest(a).parents(a).length})}
function P(b){var c=[];d(b).find("thead").first().find("th").each(function(b,a){void 0!==d(a).attr("data-field")?c[b]=d(a).attr("data-field"):c[b]=b.toString()});return c}function Q(b){var c="undefined"!==typeof b[0].cellIndex,a="undefined"!==typeof b[0].rowIndex,h=c||a?Ea(b):b.is(":visible"),g=b.data("tableexport-display");c&&"none"!==g&&"always"!==g&&(b=d(b[0].parentNode),a="undefined"!==typeof b[0].rowIndex,g=b.data("tableexport-display"));a&&"none"!==g&&"always"!==g&&(g=b.closest("table").data("tableexport-display"));
return"none"!==g&&(!0===h||"always"===g)}function Ea(b){var c=[];U&&(c=I.filter(function(){var c=!1;this.nodeType===b[0].nodeType&&("undefined"!==typeof this.rowIndex&&this.rowIndex===b[0].rowIndex?c=!0:"undefined"!==typeof this.cellIndex&&this.cellIndex===b[0].cellIndex&&"undefined"!==typeof this.parentNode.rowIndex&&"undefined"!==typeof b[0].parentNode.rowIndex&&this.parentNode.rowIndex===b[0].parentNode.rowIndex&&(c=!0));return c}));return!1===U||0===c.length}function Fa(b,c,f){var h=!1;Q(b)?0<
a.ignoreColumn.length&&(-1!==d.inArray(f,a.ignoreColumn)||-1!==d.inArray(f-c,a.ignoreColumn)||R.length>f&&"undefined"!==typeof R[f]&&-1!==d.inArray(R[f],a.ignoreColumn))&&(h=!0):h=!0;return h}function D(b,c,f,h,g){if("function"===typeof g){var k=!1;"function"===typeof a.onIgnoreRow&&(k=a.onIgnoreRow(d(b),f));if(!1===k&&-1===d.inArray(f,a.ignoreRow)&&-1===d.inArray(f-h,a.ignoreRow)&&Q(d(b))){var y=x(d(b),c),q=0;y.each(function(b){var c=d(this),a,h=S(this),k=T(this);d.each(F,function(){if(f>=this.s.r&&
f<=this.e.r&&q>=this.s.c&&q<=this.e.c)for(a=0;a<=this.e.c-this.s.c;++a)g(null,f,q++)});if(!1===Fa(c,y.length,b)){if(k||h)h=h||1,F.push({s:{r:f,c:q},e:{r:f+(k||1)-1,c:q+h-1}});g(this,f,q++)}if(h)for(a=0;a<h-1;++a)g(null,f,q++)});d.each(F,function(){if(f>=this.s.r&&f<=this.e.r&&q>=this.s.c&&q<=this.e.c)for(aa=0;aa<=this.e.c-this.s.c;++aa)g(null,f,q++)})}}}function pa(b,c,a,d){if("undefined"!==typeof d.images&&(a=d.images[a],"undefined"!==typeof a)){c=c.getBoundingClientRect();var g=b.width/b.height,
f=c.width/c.height,h=b.width,q=b.height,e=19.049976/25.4,l=0;f<=g?(q=Math.min(b.height,c.height),h=c.width*q/c.height):f>g&&(h=Math.min(b.width,c.width),q=c.height*h/c.width);h*=e;q*=e;q<b.height&&(l=(b.height-q)/2);try{d.doc.addImage(a.src,b.textPos.x,b.y+l,h,q)}catch(Ka){}b.textPos.x+=h}}function qa(b,c){if("string"===a.outputMode)return b.output();if("base64"===a.outputMode)return J(b.output());if("window"===a.outputMode)window.URL=window.URL||window.webkitURL,window.open(window.URL.createObjectURL(b.output("blob")));
else try{var d=b.output("blob");saveAs(d,a.fileName+".pdf")}catch(h){G(a.fileName+".pdf","data:application/pdf"+(c?"":";base64")+",",c?b.output("blob"):b.output())}}function ra(b,c,a){var d=0;"undefined"!==typeof a&&(d=a.colspan);if(0<=d){for(var g=b.width,f=b.textPos.x,y=c.table.columns.indexOf(c.column),q=1;q<d;q++)g+=c.table.columns[y+q].width;1<d&&("right"===b.styles.halign?f=b.textPos.x+g-b.width:"center"===b.styles.halign&&(f=b.textPos.x+(g-b.width)/2));b.width=g;b.textPos.x=f;"undefined"!==
typeof a&&1<a.rowspan&&(b.height*=a.rowspan);if("middle"===b.styles.valign||"bottom"===b.styles.valign)a=("string"===typeof b.text?b.text.split(/\r\n|\r|\n/g):b.text).length||1,2<a&&(b.textPos.y-=(2-1.15)/2*c.row.styles.fontSize*(a-2)/3);return!0}return!1}function sa(b,a,f){"undefined"!==typeof b&&null!==b&&(b.hasAttribute("data-tableexport-canvas")?(a=(new Date).getTime(),d(b).attr("data-tableexport-canvas",a),f.images[a]={url:'[data-tableexport-canvas="'+a+'"]',src:null}):"undefined"!==a&&null!=
a&&a.each(function(){if(d(this).is("img")){var a=ta(this.src);f.images[a]={url:this.src,src:this.src}}sa(b,d(this).children(),f)}))}function Ga(b,a){function c(b){if(b.url)if(b.src){var c=new Image;h=++g;c.crossOrigin="Anonymous";c.onerror=c.onload=function(){if(c.complete&&(0===c.src.indexOf("data:image/")&&(c.width=b.width||c.width||0,c.height=b.height||c.height||0),c.width+c.height)){var d=document.createElement("canvas"),f=d.getContext("2d");d.width=c.width;d.height=c.height;f.drawImage(c,0,0);
b.src=d.toDataURL("image/png")}--g||a(h)};c.src=b.url}else{var f=d(b.url);f.length&&(h=++g,html2canvas(f[0]).then(function(c){b.src=c.toDataURL("image/png");--g||a(h)}))}}var h=0,g=0;if("undefined"!==typeof b.images)for(var k in b.images)b.images.hasOwnProperty(k)&&c(b.images[k]);(b=g)||(a(h),b=void 0);return b}function ua(b,c,f){c.each(function(){if(d(this).is("div")){var c=ba(K(this,"background-color"),[255,255,255]),g=ba(K(this,"border-top-color"),[0,0,0]),k=ca(this,"border-top-width",a.jspdf.unit),
y=this.getBoundingClientRect(),q=this.offsetLeft*f.wScaleFactor,e=this.offsetTop*f.hScaleFactor,l=y.width*f.wScaleFactor;y=y.height*f.hScaleFactor;f.doc.setDrawColor.apply(void 0,g);f.doc.setFillColor.apply(void 0,c);f.doc.setLineWidth(k);f.doc.rect(b.x+q,b.y+e,l,y,k?"FD":"F")}else d(this).is("img")&&(c=ta(this.src),pa(b,this,c,f));ua(b,d(this).children(),f)})}function va(b,c,f){if("function"===typeof f.onAutotableText)f.onAutotableText(f.doc,b,c);else{var h=b.textPos.x,g=b.textPos.y,k={halign:b.styles.halign,
valign:b.styles.valign};if(c.length){for(c=c[0];c.previousSibling;)c=c.previousSibling;for(var y=!1,q=!1;c;){var e=c.innerText||c.textContent||"",l=e.length&&" "===e[0]?" ":"",m=1<e.length&&" "===e[e.length-1]?" ":"";!0!==a.preserve.leadingWS&&(e=l+ha(e));!0!==a.preserve.trailingWS&&(e=ia(e)+m);d(c).is("br")&&(h=b.textPos.x,g+=f.doc.internal.getFontSize());d(c).is("b")?y=!0:d(c).is("i")&&(q=!0);(y||q)&&f.doc.setFontType(y&&q?"bolditalic":y?"bold":"italic");if(l=f.doc.getStringUnit